\section{Conclusion}
In this paper, we present a two-hierarchies embedding model to generate a feature vector for extracting CFG of app's functions. We propose a prototype called 3TU-CFG, which has a scalable and effective power on the app homology analysis. The embedding feature vector is carefully designed objective functions that preserve both the first-order and second-order proximities of CFG for functions, which is called 5UD-CFG. At the same time, we can prove the monotonous of first-hierarchy embedding 5UD-CFG. An effective and efficient compress and clustering algorithm based on the second-hierarchy tensor embedding model is proposed for generating 3TU-CFG. Our extensive evaluation shows that 3TU-CFG outperforms the current other approaches by large margins with respect to similarity detection accuracy, embedding generation time and overall search time. The real dataset demonstrate that 3TU-CFG significantly improve detection accuracy and search effective.      